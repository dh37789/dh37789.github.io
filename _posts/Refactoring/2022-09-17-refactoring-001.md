---
title:  "[Refactoring] 냄새 1. 이해하기 힘든 이름"

categories: Refactoring

toc: true
toc_sticky: true

date: 2022-09-17
last_modified_at: 2022-09-17
---

# 냄새 1. 이해하기 힘든 이름 (Mysterious Name)

- 깔끔한 코드에서 가장 중요한 것 중 하나가 바로 "좋은 이름"이다.
- 함수, 변수, 클래스, 모듈의 이름 등 모두 어떤 역할을 하는지 어떻게 쓰이는지 직관적이어야 한다.
- **처음부터 변수명이나, 함수명을 완벽하게 지을 수 없다. 코드를 다시한번 검토하면서 변수명을 신경쓰거나, 변경/수정하는 좋은 습관을 들이는것이 중요하다.**
- 사용할 수 있는 리팩토링 기술
  - 함수 선언 변경하기 (Change Function Declaration)
  - 변수 이름 바꾸기 (Rename Variable)
  - 필드 이름 바꾸기 (Rename Field)

## 리팩토링 1. 함수 선언 변경하기

함수 이름 변경하기, 메소드 이름 변경하기, 매개변수 추가하기, 매개변수 제거하기, 시그니처 변경하기

- 좋은 이름을 가진 함수는 함수가 어떻게 구현되었는지 코드를 보지않아도 이름만 보고도 이해할 수 있다.
- 좋은 이름을 찾아내는 방법? 함수에 주석을 작성한 다음, 주석을 함수 이름으로 만들어 본다.
- 함수의 매개변수는
  - 함수 내부의 문맥을 결정한다 (예. 전화번호 포매팅 함수, 어떤 타입으로 받을 것인지, 함수 내부에 많은 정보를 줄것인지, 필요한 것만 줄것인지.. 등등
  - 의존성을 결정한다. (예. Payment 만기일 계산 함수, Payment에 종속된다면 Payment타입을, date속성만 필요하다면 date만 넘겨줄것인지 등등..)

## 예제 코드

```java
public class StudyDashboard {

    private Set<String> usernames = new HashSet<>();

    private Set<String> reviews = new HashSet<>();

    /**
     * 스터디 리뷰 이슈에 작성되어 있는 리뷰어 목록과 리뷰를 읽어온다.
     * @param issue
     * @throws IOException
     */
    private void studyReviews(GHIssue issue) throws IOException {
        List<GHIssueComment> comments = issue.getComments();
        for (GHIssueComment comment : comments) {
            usernames.add(comment.getUserName());
            reviews.add(comment.getBody());
        }
    }

    public Set<String> getUsernames() {
        return usernames;
    }

    public Set<String> getReviews() {
        return reviews;
    }

    public static void main(String[] args) throws IOException {
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("dh37789/basic");
        GHIssue issue = repository.getIssue(1);

        StudyDashboard studyDashboard = new StudyDashboard();
        studyDashboard.studyReviews(issue);
        studyDashboard.getUsernames().forEach(System.out::println);
        studyDashboard.getReviews().forEach(System.out::println);
    }
}
```

해당 코드는, 깃허브의 repository에서 이슈에 대한 리뷰와, 리뷰어의 목록을 불러오는 코드이다.

`studyReviews` 함수를 보면, `GHIssue` 객체를 받아, `GHIssueComment`에 해당 이슈에 대한 유저와 리뷰를 불러오는 역할을 한다. `studyReviews`의 함수명만 본다면 위에 해당하는 역할이 떠오르는가?  
한번 역할에 맞게 해당 코드를 리팩토링 해보도록 하자.

### 1. 역할에 맞는 함수명 변경

> IntelliJ에서 함수명을 클릭한 뒤 Shift + F6을 누르면 함수명과 외부에서 사용하고있는 종속되어 호출되거나 선언된 함수명을 모두 변경해 줄 수 있다.

먼저 repository의 reivew를 호출하는 함수이기 때문에, `studyReviews` 에서 `loadReviews`라는 이름으로 변경을 해주도록 하자.

```java
private void loadReviews(GHIssue issue) throws IOException {
    List<GHIssueComment> comments = issue.getComments();
    for (GHIssueComment comment : comments) {
        usernames.add(comment.getUserName());
        reviews.add(comment.getBody());
    }
}
```

### 2. 함수역할에 따른 매개변수 변경

메인 함수를 보면 호출하는 리뷰는 정해져 있다. 만약 해당 함수가 특정되지 않은 repository의 특정되지 않는 issue를 가져온다면, 매개변수는 달라질 것이다. 

```java
GitHub gitHub = GitHub.connect();
GHRepository repository = gitHub.getRepository("dh37789/basic");
GHIssue issue = repository.getIssue(1);
```

하지만 main함수 내에 선언되어있는 repository와 issue는 dh37789/basic와, 1번으로 고정해져 있다. 이뜻은 파라미터를 따로 주지 않아도 된다는 뜻이다.
그렇다면, 매개변수로 issue의 정보를 따로 넘겨주지 않아도 될것이다. issue를 불러오는 코드를 `loadReviews`안에 넣어주도록 하자.

```java
private void loadReviews() throws IOException {
    GitHub gitHub = GitHub.connect();
    GHRepository repository = gitHub.getRepository("dh37789/basic");
    GHIssue issue = repository.getIssue(1);

    List<GHIssueComment> comments = issue.getComments();
    for (GHIssueComment comment : comments) {
        usernames.add(comment.getUserName());
        reviews.add(comment.getBody());
    }
}
```

전체적인 코드를 보자면 아래의 코드를 확인할 수 있다.

```java
public class StudyDashboardRefactoring {

    private Set<String> usernames = new HashSet<>();

    private Set<String> reviews = new HashSet<>();

    /**
     * Github API를 이용하여, dh37789/basic 레포지토리의 1번 이슈에 대한 리뷰어와, 리뷰를 불러온다.
     * @throws IOException
     */
    private void loadReviews() throws IOException {
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("dh37789/basic");
        GHIssue issue = repository.getIssue(1);

        List<GHIssueComment> comments = issue.getComments();
        for (GHIssueComment comment : comments) {
            usernames.add(comment.getUserName());
            reviews.add(comment.getBody());
        }
    }

    public Set<String> getUsernames() {
        return usernames;
    }

    public Set<String> getReviews() {
        return reviews;
    }

    public static void main(String[] args) throws IOException {
        StudyDashboardRefactoring studyDashboard = new StudyDashboardRefactoring();
        studyDashboard.loadReviews();
        studyDashboard.getUsernames().forEach(System.out::println);
        studyDashboard.getReviews().forEach(System.out::println);
    }
}
```



