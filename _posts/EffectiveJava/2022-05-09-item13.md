---
title: "[EffectiveJava] item13 - clone 재정의는 주의해서 진행하라."

categories: EffectiveJava

toc: true
toc_sticky: EffectiveJava

date: 2022-05-09
last_modified_at: 2022-05-09
---

# clone 재정의는 주의해서 진행하라.

Cloneable은 복제해도 되는 클래스임을 명시하는 용도의 믹스인 인터페이스 (mixin interface)지만, clone 메서드가 선언된 곳이 Cloneable이 아닌 Object이고, protected라는 문제점이 있다.

> clone() 메서드는 원본 객체의 필드값과 동일한 값을 가지는 새로운 객체를 생성한다. Cloneable를 implements하여 사용 한다.

## Cloneable의 동작방식

Cloneable 인터페이스는 Object의 protected 메서드인 clone의 동작 방식을 결정 한다.

1. Cloneable을 구현한 클래스의 인스턴스에서 clone을 호출하면 그 객체의 필드들을 하나하나 복사한 객체들을 반환한다. 
2. Cloneable을 구현하지 않을 경우 CloneNotSupportedException을 던진다.

## Object 명세에서 가져온 clone 설명

> 이 객체의 복사본을 생성해 반환한다. '복사'의 정확한 뜻은 그 객체를 구현한 클래스에 따라 다를 수 있다. 일반적인 의도는 다음과 같다. 어떤 객체 x에 대해 다음 식은 참이다.
>
> `x.clone() != x`
>
> 또한 다음 식도 참이다.
> 
> `x.clone().getClass() == x.getClass()`
> 
> 하지만 이상의 요구를 반드시 만족해야 하는 것은 아니다.
> 한편 다음 식도 일반적으로 참이지만, 역시 필수는 아니다.
> 
> `x.clone().equals(x)`
> 
> 관례상, 이 메서드가 반환하는 객체는 `super.clone`을 호출해 얻어야 한다. 이클래스와
> (Object를 제외한) 모든 상위 클래스가 이 관례를 따른다면 다음 식은 참이다.
> 
> `x.clone().getClass() == x.getClass()`
> 
> 관례상, 반환된 객체와 원본 객체는 독립적이어야 한다. 이를 만족하여면 `super.clone`으로 얻은 객체의 필드 중 하나 이상을 반환 전에 수정해야 할 수도 있다.